---
import { useTranslation, type Language, getLocalizedPage, DEFAULT_LOCALE } from "@/utils/i18n";
import Nav from "./Nav.astro";

interface Props {
  lang?: Language;
}

const basePath = Astro.url.pathname;

const lang = Astro.props.lang ?? DEFAULT_LOCALE;
const t = useTranslation(lang);
---

<header id="header" class="top-0 w-full bg-white shadow-lg transition-transform dark:bg-slate-950/80">
  <div class="mx-auto max-w-7xl px-2 md:border-none md:px-6 lg:px-8">
    <div class="relative flex h-20 items-center justify-between">
      <div class="absolute inset-y-0 left-0 flex items-center md:hidden">
        <button
          type="button"
          class="inline-flex items-center justify-center rounded-md p-2 dark:hover:bg-gray-700"
          aria-controls="mobile-menu"
          aria-expanded="false"
        >
          <span class="sr-only" data-open-text={t("ui", "open_menu")} data-close-text={t("ui", "close_menu")}
            >{t("ui", "open_menu")}</span
          >
          <svg class="block h-6 w-6" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5"
            ></path>
          </svg>
        </button>
      </div>
      <div class="grid flex-1 items-center justify-center md:grid-cols-6 md:gap-4 lg:grid-cols-4">
        <div class="col-start-2 flex shrink-0 items-center md:col-span-2 md:col-start-1 lg:col-span-1">
          <a class="inline-block" href={getLocalizedPage(lang, "home")} title={t('navigation', 'go_home')}>
            <svg viewBox="0 0 300 32" class="w-56 max-w-full md:w-72" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path
                d="M18.163 9.564L7.78 16.026l10.382 6.547-1.077 1.336-10.827-6.792v-2.24l10.97-6.778.934 1.465zm275.625 5.313v2.24l-10.827 6.792-1.077-1.393 10.382-6.49-14.144-8.86-10.094 20.72-1.479-.646 12.363-25.415 1.45.732-1.507 3.087 14.933 9.233z"
                class="fill-slate-600 dark:fill-slate-100"></path>
              <path
                d="M31.039 25h-3.332V7.87h-5.944V5.185h15.364l-.345 2.685H31.04V25zm21.132-3.719c0 .584.086 1.015.258 1.292.182.278.479.484.89.618l-.717 2.182c-.776-.086-1.427-.296-1.953-.632-.527-.334-.924-.823-1.192-1.464a5.272 5.272 0 01-2.082 1.58c-.842.354-1.761.53-2.757.53-1.015 0-1.9-.195-2.656-.588a4.157 4.157 0 01-1.723-1.651c-.402-.709-.603-1.532-.603-2.47 0-1.599.622-2.829 1.866-3.69 1.254-.862 3.035-1.293 5.342-1.293h2.168v-.99c0-.958-.287-1.656-.862-2.097-.574-.44-1.411-.66-2.512-.66-.527 0-1.144.067-1.853.2a15.48 15.48 0 00-2.182.59l-.79-2.27a16.62 16.62 0 012.742-.775c.91-.172 1.767-.258 2.57-.258 2.002 0 3.51.44 4.524 1.32 1.015.882 1.522 2.136 1.522 3.763v6.763zm-6.577 1.738c.661 0 1.298-.173 1.91-.517a4.208 4.208 0 001.508-1.45v-3.346h-1.78c-1.465 0-2.537.244-3.217.732-.67.479-1.005 1.177-1.005 2.096 0 .814.215 1.431.646 1.853.44.42 1.087.631 1.938.631zM65.75 25h-3.762L56.647 9.837h3.446l3.848 12.492 3.863-12.492h3.288L65.75 25zm11.957-6.548c.086 1.484.503 2.595 1.25 3.332.756.737 1.718 1.105 2.886 1.105a6.11 6.11 0 002.024-.33 8.947 8.947 0 001.953-.99l1.393 1.923a8.104 8.104 0 01-2.513 1.393 9.06 9.06 0 01-3.015.503c-1.542 0-2.863-.33-3.963-.991-1.101-.67-1.934-1.603-2.499-2.8-.565-1.197-.847-2.585-.847-4.164 0-1.522.277-2.886.833-4.092.564-1.216 1.369-2.169 2.412-2.858 1.043-.699 2.269-1.048 3.676-1.048 1.33 0 2.484.306 3.46.919.986.603 1.743 1.474 2.27 2.613.535 1.14.803 2.49.803 4.05 0 .526-.024 1.005-.072 1.435h-10.05zm3.619-6.634c-1.044 0-1.886.374-2.528 1.12-.641.738-1.01 1.843-1.105 3.317h7.021c-.028-1.426-.335-2.522-.919-3.288-.584-.766-1.407-1.149-2.47-1.149zm21.692-2.369c.421 0 .809.034 1.163.1.354.068.727.163 1.12.288l-.546 5.586h-2.297v-3.088c-1.063.039-1.982.465-2.757 1.278-.775.804-1.393 1.958-1.852 3.46v5.63h3.058V25h-8.5v-2.297h2.225V12.12h-2.226V9.837h4.681l.59 3.518c.583-1.312 1.296-2.288 2.139-2.93.852-.65 1.919-.976 3.202-.976zm18.059 11.832c0 .584.086 1.015.259 1.292.182.278.478.484.89.618l-.718 2.182c-.775-.086-1.426-.296-1.953-.632-.526-.334-.924-.823-1.192-1.464a5.262 5.262 0 01-2.082 1.58c-.842.354-1.761.53-2.757.53-1.014 0-1.9-.195-2.656-.588a4.154 4.154 0 01-1.723-1.651c-.402-.709-.603-1.532-.603-2.47 0-1.599.622-2.829 1.866-3.69 1.254-.862 3.035-1.293 5.342-1.293h2.168v-.99c0-.958-.287-1.656-.861-2.097-.575-.44-1.412-.66-2.513-.66-.527 0-1.144.067-1.852.2-.709.135-1.436.331-2.183.59l-.79-2.27a16.608 16.608 0 012.743-.775 13.832 13.832 0 012.57-.258c2.001 0 3.508.44 4.523 1.32 1.015.882 1.522 2.136 1.522 3.763v6.763zm-6.576 1.738c.66 0 1.297-.173 1.91-.517a4.208 4.208 0 001.507-1.45v-3.346h-1.78c-1.465 0-2.537.244-3.217.732-.67.479-1.005 1.177-1.005 2.096 0 .814.216 1.431.646 1.853.441.42 1.087.631 1.939.631zm17.729-.101c1.015 0 1.814-.177 2.398-.531.593-.364.89-.862.89-1.494 0-.44-.091-.799-.273-1.077-.172-.277-.517-.536-1.034-.775-.516-.249-1.297-.507-2.34-.775-1.091-.278-1.996-.594-2.714-.948-.718-.364-1.278-.828-1.68-1.393-.392-.574-.589-1.287-.589-2.14 0-.86.244-1.617.733-2.268.497-.66 1.201-1.173 2.11-1.536.919-.364 1.992-.546 3.217-.546 2.249 0 4.169.584 5.758 1.752l-1.35 2.024a8.376 8.376 0 00-2.025-.976 7.045 7.045 0 00-2.297-.36c-1.915 0-2.872.56-2.872 1.68 0 .384.11.7.33.949.221.239.594.469 1.12.689.537.21 1.341.464 2.413.76 1.091.307 1.986.642 2.685 1.006.699.364 1.24.842 1.622 1.436.393.593.589 1.354.589 2.283 0 1.043-.306 1.92-.919 2.628-.612.708-1.426 1.235-2.441 1.58-1.005.334-2.115.502-3.331.502-1.331 0-2.513-.192-3.547-.575-1.034-.383-1.929-.904-2.685-1.565l1.709-1.953a7.006 7.006 0 004.523 1.622zM157.885 25h-3.044l-.474-9.65a97.955 97.955 0 01-.086-3.948c0-1.216.024-2.312.072-3.288l-2.915 13.397h-2.901l-3.13-13.397c.086 1.311.129 2.819.129 4.523 0 .91-.014 1.823-.043 2.742L145.106 25h-2.987l1.12-19.815h3.992l2.829 13.282 2.699-13.282h4.006L157.885 25zm9.329-22.587c.623 0 1.13.192 1.522.575.393.383.589.861.589 1.436 0 .584-.196 1.072-.589 1.464-.392.383-.899.575-1.522.575-.612 0-1.115-.192-1.507-.575-.393-.392-.589-.88-.589-1.464 0-.575.196-1.053.589-1.436.392-.383.895-.575 1.507-.575zm2.24 20.232h4.121V25H161.7v-2.355h4.538V12.192h-4.394V9.837h7.61v12.808zm14.456.273c1.014 0 1.814-.177 2.398-.531.593-.364.89-.862.89-1.494 0-.44-.091-.799-.273-1.077-.172-.277-.517-.536-1.034-.775-.517-.249-1.297-.507-2.34-.775-1.092-.278-1.996-.594-2.714-.948-.718-.364-1.278-.828-1.68-1.393-.393-.574-.589-1.287-.589-2.14 0-.86.244-1.617.732-2.268.498-.66 1.202-1.173 2.111-1.536.919-.364 1.991-.546 3.217-.546 2.249 0 4.168.584 5.757 1.752l-1.349 2.024a8.394 8.394 0 00-2.025-.976 7.049 7.049 0 00-2.297-.36c-1.915 0-2.872.56-2.872 1.68 0 .384.11.7.33.949.22.239.594.469 1.12.689.536.21 1.34.464 2.412.76 1.092.307 1.987.642 2.686 1.006.698.364 1.239.842 1.622 1.436.393.593.589 1.354.589 2.283 0 1.043-.306 1.92-.919 2.628-.613.708-1.426 1.235-2.441 1.58-1.005.334-2.116.502-3.331.502-1.331 0-2.513-.192-3.547-.575-1.034-.383-1.929-.904-2.685-1.565l1.709-1.953a7.016 7.016 0 004.523 1.622zm23.3-1.637c0 .584.086 1.015.258 1.292.182.278.479.484.891.618l-.718 2.182c-.776-.086-1.427-.296-1.953-.632-.527-.334-.924-.823-1.192-1.464a5.27 5.27 0 01-2.082 1.58c-.842.354-1.761.53-2.757.53-1.015 0-1.9-.195-2.656-.588a4.154 4.154 0 01-1.723-1.651c-.402-.709-.603-1.532-.603-2.47 0-1.599.622-2.829 1.866-3.69 1.254-.862 3.035-1.293 5.342-1.293h2.168v-.99c0-.958-.287-1.656-.862-2.097-.574-.44-1.411-.66-2.512-.66-.527 0-1.144.067-1.853.2-.708.135-1.436.331-2.182.59l-.79-2.27a16.608 16.608 0 012.743-.775 13.832 13.832 0 012.57-.258c2.001 0 3.508.44 4.523 1.32 1.015.882 1.522 2.136 1.522 3.763v6.763zm-6.576 1.738a3.84 3.84 0 001.909-.517 4.203 4.203 0 001.508-1.45v-3.346h-1.78c-1.465 0-2.537.244-3.217.732-.67.479-1.005 1.177-1.005 2.096 0 .814.215 1.431.646 1.853.44.42 1.087.631 1.939.631zm14.886-4.567c.086 1.484.502 2.595 1.249 3.332.756.737 1.718 1.105 2.886 1.105.718 0 1.393-.11 2.025-.33a8.958 8.958 0 001.952-.99l1.393 1.923a8.096 8.096 0 01-2.513 1.393 9.056 9.056 0 01-3.015.503c-1.541 0-2.862-.33-3.963-.991-1.101-.67-1.934-1.603-2.498-2.8-.565-1.197-.848-2.585-.848-4.164 0-1.522.278-2.886.833-4.092.565-1.216 1.369-2.169 2.412-2.858 1.044-.699 2.269-1.048 3.676-1.048 1.331 0 2.484.306 3.461.919.986.603 1.742 1.474 2.269 2.613.536 1.14.804 2.49.804 4.05 0 .526-.024 1.005-.072 1.435H215.52zm3.618-6.634c-1.043 0-1.886.374-2.527 1.12-.641.738-1.01 1.843-1.106 3.317h7.022c-.029-1.426-.335-2.522-.919-3.288-.584-.766-1.407-1.149-2.47-1.149zm17.6 9.047c0 .67.201 1.158.603 1.464.412.307.976.46 1.694.46.766 0 1.566-.168 2.398-.503l.819 2.24c-1.13.575-2.432.862-3.906.862-1.005 0-1.871-.192-2.599-.575a3.988 3.988 0 01-1.665-1.665c-.374-.728-.56-1.585-.56-2.57V6.117h-4.581v-2.37h7.797v17.117z"
                class="fill-slate-900 dark:fill-blue-100"></path>
            </svg>
          </a>
        </div>
        <div class="hidden md:col-span-3 md:block lg:col-span-2">
          <Nav lang={lang} activePage={basePath} />
        </div>
        <div class="insert-0 absolute right-1 flex items-center justify-self-end pr-2 md:relative md:right-0">
          <button
            id="search-button"
            class="rounded-full p-2 hover:bg-blue-100/40 dark:hover:bg-gray-700/40 dark:hover:text-white"
          >
            <span class="sr-only">{t("ui", "search")}</span>
            <svg
              class="h-6 w-6"
              fill="none"
              viewBox="0 0 24 24"
              stroke-width="1.5"
              stroke="currentColor"
              aria-hidden="true"
            >
              <path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"
              ></path>
            </svg>
          </button>
        </div>
      </div>
    </div>
  </div>
  <div class="mobile-menu grid transition-all md:hidden" id="mobile-menu" aria-hidden="true">
    <div class="overflow-hidden"><Nav lang={lang} isMobile activePage={basePath} /></div>
  </div>
</header>

<script src="./utils/mobile-menu.ts"></script>
<style>
  .mobile-menu {
    grid-template-rows: 0fr;
  }

  .mobile-menu.open {
    grid-template-rows: 1fr;
  }
</style>
