---
import { getEntryBySlug, CollectionEntry } from "astro:content";
import { Image } from "astro:assets";
import Admonition from "@/components/content/Admonition/Admonition.astro";
import Layout from "@/layouts/Basic.astro";

interface Props {
  entry: CollectionEntry<"posts">;
}

const entry = await getEntryBySlug("posts", Object.values(Astro.params).join("/"));

if (!entry) {
  return Astro.redirect(`/404?from=${Astro.url.pathname.substring(-1)}`);
}

const { Content } = await entry.render();
const meta = {
  title: `${entry.data.title} â€” TaverasMisael`,
  description: entry.data.description,
  canonical: entry.slug,
  ogTitle: entry.data.title,
  ogType: "article",
};

const components = {
  // eslint-disable-next-line @typescript-eslint/no-unsafe-assignment
  Admonition: Admonition,
};
---

<Layout lang={Astro.params.lang} description={meta.description} title={entry.data.title}>
  <main
    class="prose prose-blue dark:prose-invert lg:prose-lg prose-img:mx-auto prose-img:rounded-sm prose-img:shadow-sm mx-auto px-4"
  >
    <article>
      <Image
        alt={entry.data.title}
        src={entry.data.banner.src}
        width={entry.data.banner.width}
        height={entry.data.banner.height}
      />
      <h1>{entry.data.title}</h1>
      <Content components={components} />
    </article>
  </main>
</Layout>